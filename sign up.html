<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Join EverGreen Empire | Creator Signup</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    :root {
      --navy: #071b3b;
      --gold: #cda349;
      --light-gold: #e6d4a8;
      --white: #ffffff;
      --light: #f5f7fa;
      --success: #28a745;
      --danger: #dc3545;
      --border-radius: 16px;
      --shadow: 0 10px 30px rgba(7, 27, 59, 0.15);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Poppins", sans-serif;
    }

    body {
      background: linear-gradient(135deg, var(--navy) 0%, #0a2458 100%);
      color: var(--white);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 20px;
      position: relative;
    }

    /* Background decoration */
    .bg-decoration {
      position: absolute;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: -1;
    }

    .bg-circle {
      position: absolute;
      border-radius: 50%;
      background: rgba(205, 163, 73, 0.1);
    }

    .circle-1 {
      width: 300px;
      height: 300px;
      top: -150px;
      right: -100px;
    }

    .circle-2 {
      width: 200px;
      height: 200px;
      bottom: -80px;
      left: -80px;
    }

    /* Signup Container */
    .signup-container {
      width: 100%;
      max-width: 480px;
      padding: 20px;
      animation: fadeIn 0.8s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .signup-box {
      background: var(--white);
      border-radius: var(--border-radius);
      padding: 40px 35px;
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
    }

    .signup-box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: linear-gradient(90deg, var(--gold), var(--navy));
    }

    .logo {
      text-align: center;
      margin-bottom: 30px;
    }

    .logo h1 {
      font-size: 2.2em;
      color: var(--navy);
      font-weight: 800;
      margin-bottom: 5px;
      letter-spacing: -0.5px;
    }

    .logo .subtitle {
      color: var(--gold);
      font-size: 1em;
      font-weight: 600;
      letter-spacing: 1px;
    }

    .signup-box h2 {
      color: var(--navy);
      font-size: 1.6em;
      margin-bottom: 25px;
      font-weight: 700;
      text-align: center;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-row {
      display: flex;
      gap: 15px;
    }

    .form-row .form-group {
      flex: 1;
    }

    .signup-box input,
    .signup-box select {
      width: 100%;
      padding: 14px 16px;
      border-radius: 10px;
      border: 2px solid #e0e0e0;
      font-size: 1em;
      outline: none;
      transition: all 0.3s ease;
      background: var(--white);
      color: var(--navy);
      font-weight: 500;
    }

    .signup-box input:focus,
    .signup-box select:focus {
      border-color: var(--gold);
      box-shadow: 0 0 0 3px rgba(205, 163, 73, 0.15);
      transform: translateY(-2px);
    }

    .signup-box input.error {
      border-color: var(--danger);
    }

    .password-container {
      position: relative;
    }

    .password-toggle {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #666;
      cursor: pointer;
      font-size: 1.2em;
      padding: 5px;
      transition: color 0.3s;
    }

    .password-toggle:hover {
      color: var(--navy);
    }

    .btn {
      display: inline-block;
      background: linear-gradient(135deg, var(--navy) 0%, #0a2458 100%);
      color: var(--white);
      padding: 16px 20px;
      border-radius: 10px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
      width: 100%;
      font-size: 1em;
      margin-top: 10px;
      letter-spacing: 0.5px;
      box-shadow: 0 4px 15px rgba(7, 27, 59, 0.2);
    }

    .btn:hover {
      background: linear-gradient(135deg, var(--gold) 0%, #d4af37 100%);
      color: var(--navy);
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(205, 163, 73, 0.3);
    }

    .btn:active {
      transform: translateY(-1px);
    }

    .btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .btn.loading {
      position: relative;
      color: transparent;
    }

    .btn.loading::after {
      content: "";
      position: absolute;
      width: 20px;
      height: 20px;
      top: 50%;
      left: 50%;
      margin-left: -10px;
      margin-top: -10px;
      border: 2px solid var(--white);
      border-radius: 50%;
      border-top-color: transparent;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .terms {
      font-size: 0.85em;
      color: #666;
      text-align: center;
      margin: 20px 0;
      line-height: 1.5;
    }

    .terms a {
      color: var(--navy);
      text-decoration: none;
      font-weight: 600;
      transition: color 0.3s;
    }

    .terms a:hover {
      color: var(--gold);
      text-decoration: underline;
    }

    .login-link {
      text-align: center;
      margin-top: 25px;
      font-size: 0.9em;
      color: #666;
    }

    .login-link a {
      color: var(--navy);
      text-decoration: none;
      font-weight: 600;
      transition: color 0.3s;
    }

    .login-link a:hover {
      color: var(--gold);
      text-decoration: underline;
    }

    /* Notification */
    .notification {
      padding: 14px 16px;
      border-radius: 10px;
      margin-bottom: 20px;
      font-size: 0.9em;
      display: none;
      text-align: left;
      border-left: 4px solid;
      animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-10px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .notification.error {
      background-color: #f8d7da;
      color: #721c24;
      border-left-color: var(--danger);
      display: block;
    }

    .notification.success {
      background-color: #d4edda;
      color: #155724;
      border-left-color: var(--success);
      display: block;
    }

    /* Footer */
    .footer {
      margin-top: 30px;
      text-align: center;
      color: rgba(255, 255, 255, 0.7);
      font-size: 0.8em;
      max-width: 480px;
    }

    .footer a {
      color: var(--light-gold);
      text-decoration: none;
      transition: color 0.3s;
    }

    .footer a:hover {
      color: var(--white);
      text-decoration: underline;
    }

    .footer-links {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 10px;
    }

    /* Mobile Responsiveness */
    @media (max-width: 768px) {
      .form-row {
        flex-direction: column;
        gap: 0;
      }
      
      .signup-box {
        padding: 30px 25px;
      }
      
      .logo h1 {
        font-size: 1.9em;
      }

      .signup-box h2 {
        font-size: 1.4em;
      }
      
      .footer-links {
        flex-direction: column;
        gap: 5px;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 15px;
        justify-content: flex-start;
        padding-top: 40px;
      }
      
      .signup-container {
        padding: 10px;
      }
      
      .signup-box {
        padding: 25px 20px;
        border-radius: 12px;
      }
      
      .logo h1 {
        font-size: 1.7em;
      }
      
      .logo .subtitle {
        font-size: 0.9em;
      }
      
      .signup-box h2 {
        font-size: 1.3em;
        margin-bottom: 20px;
      }
      
      .signup-box input,
      .signup-box select {
        padding: 12px 14px;
        font-size: 0.95em;
      }
      
      .btn {
        padding: 14px 20px;
        font-size: 0.95em;
      }
      
      .terms {
        font-size: 0.8em;
      }
      
      .login-link {
        font-size: 0.85em;
      }
      
      .footer {
        margin-top: 20px;
        font-size: 0.75em;
      }
    }

    @media (max-width: 360px) {
      .logo h1 {
        font-size: 1.5em;
      }
      
      .signup-box h2 {
        font-size: 1.2em;
      }
      
      .signup-box {
        padding: 20px 15px;
      }
    }

    /* Password strength indicator */
    .password-strength {
      height: 4px;
      border-radius: 2px;
      margin-top: 5px;
      background: #e0e0e0;
      overflow: hidden;
    }

    .password-strength-bar {
      height: 100%;
      width: 0%;
      transition: width 0.3s, background 0.3s;
    }

    .strength-weak {
      background: var(--danger);
      width: 33%;
    }

    .strength-medium {
      background: #ffc107;
      width: 66%;
    }

    .strength-strong {
      background: var(--success);
      width: 100%;
    }
  </style>
</head>

<body>
  <!-- Background decoration -->
  <div class="bg-decoration">
    <div class="bg-circle circle-1"></div>
    <div class="bg-circle circle-2"></div>
  </div>

  <!-- Signup Container -->
  <div class="signup-container">
    <div class="signup-box">
      <div class="logo">
        <h1>EverGreen Empire</h1>
        <div class="subtitle">CREATOR PROGRAM</div>
      </div>

      <h2>Join Our Creator Community</h2>

      <div id="notification" class="notification"></div>

      <form id="signup-form">
        <div class="form-row">
          <div class="form-group">
            <input type="text" id="firstName" placeholder="First Name" required>
          </div>
          <div class="form-group">
            <input type="text" id="lastName" placeholder="Last Name" required>
          </div>
        </div>

        <div class="form-group">
          <input type="email" id="email" placeholder="Email Address" required>
        </div>

        <div class="form-group">
          <input type="text" id="channelName" placeholder="YouTube Channel Name" required>
        </div>

        <div class="form-group">
          <select id="contentType" required>
            <option value="">Select Content Type</option>
            <option value="gaming">Gaming</option>
            <option value="vlogs">Vlogs & Lifestyle</option>
            <option value="education">Educational</option>
            <option value="music">Music & Entertainment</option>
            <option value="tech">Tech Reviews</option>
            <option value="beauty">Beauty & Fashion</option>
            <option value="other">Other</option>
          </select>
        </div>

        <div class="form-group">
          <div class="password-container">
            <input type="password" id="password" placeholder="Password" required>
            <button type="button" class="password-toggle" onclick="togglePassword('password')">👁️</button>
          </div>
          <div class="password-strength">
            <div class="password-strength-bar" id="password-strength-bar"></div>
          </div>
        </div>

        <div class="form-group">
          <div class="password-container">
            <input type="password" id="confirmPassword" placeholder="Confirm Password" required>
            <button type="button" class="password-toggle" onclick="togglePassword('confirmPassword')">👁️</button>
          </div>
        </div>

        <div class="terms">
          By creating an account, you agree to our 
          <a href="Terms of Service.html">Terms of Service</a>, 
          <a href="Privacy policy.html">Privacy Policy</a>, and
          <a href="Creator Agreement.html">Creator Agreement</a>
        </div>

        <button type="submit" class="btn" id="signupBtn">
          <span>Create Account</span>
        </button>
      </form>

      <div class="login-link">
        Already have an account? <a href="login.html">Sign in here</a>
      </div>
    </div>
  </div>

  <div class="footer">
    <p>© 2025 EverGreen Empire Ltd — Creator Platform</p>
    <div class="footer-links">
      <a href="index.html">← Back to Home</a>
      <a href="mailto:support@evergreenempireltd.com">Contact Support</a>
    </div>
  </div>

  <script>
    // Supabase Configuration
    const SUPABASE_URL = 'https://saerrnuzddfxfthllvpr.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNhZXJybnV6ZGRmeGZ0aGxsdnByIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE4MjM0OTIsImV4cCI6MjA3NzM5OTQ5Mn0.u7f365U3CFFq_BF2NSnT9WhDGw0bZ8PjnmzphCwYPMM';
    
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // Notification system
    function showNotification(message, type = 'error') {
      const notification = document.getElementById('notification');
      notification.textContent = message;
      notification.className = `notification ${type}`;
      
      if (type === 'success') {
        setTimeout(() => {
          notification.style.display = 'none';
        }, 5000);
      }
    }

    // Toggle password visibility
    function togglePassword(fieldId) {
      const passwordInput = document.getElementById(fieldId);
      const toggleButton = passwordInput.parentNode.querySelector('.password-toggle');
      
      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        toggleButton.textContent = '🙈';
      } else {
        passwordInput.type = 'password';
        toggleButton.textContent = '👁️';
      }
    }

    // Check password strength
    function checkPasswordStrength(password) {
      const strengthBar = document.getElementById('password-strength-bar');
      let strength = 0;
      
      if (password.length >= 8) strength++;
      if (password.match(/[a-z]/) && password.match(/[A-Z]/)) strength++;
      if (password.match(/\d/)) strength++;
      if (password.match(/[^a-zA-Z\d]/)) strength++;
      
      strengthBar.className = 'password-strength-bar';
      
      if (password.length === 0) {
        strengthBar.style.width = '0%';
      } else if (strength <= 1) {
        strengthBar.className += ' strength-weak';
      } else if (strength <= 3) {
        strengthBar.className += ' strength-medium';
      } else {
        strengthBar.className += ' strength-strong';
      }
    }

    // Validate form data
    function validateForm(formData) {
      const errors = [];
      
      // Check required fields
      if (!formData.firstName.trim()) errors.push('First name is required');
      if (!formData.lastName.trim()) errors.push('Last name is required');
      if (!formData.email.trim()) errors.push('Email is required');
      if (!formData.channelName.trim()) errors.push('YouTube channel name is required');
      if (!formData.contentType) errors.push('Content type is required');
      if (!formData.password) errors.push('Password is required');
      
      // Validate email format
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (formData.email && !emailRegex.test(formData.email)) {
        errors.push('Please enter a valid email address');
      }
      
      // Check password strength
      if (formData.password.length < 8) {
        errors.push('Password must be at least 8 characters long');
      }
      
      // Check if passwords match
      if (formData.password !== formData.confirmPassword) {
        errors.push('Passwords do not match');
      }
      
      return errors;
    }

    // Create user profile in database
    async function createUserProfile(userId, userData) {
      try {
        const { data, error } = await supabase
          .from('profiles')
          .insert([
            {
              id: userId,
              full_name: `${userData.firstName} ${userData.lastName}`,
              email: userData.email,
              youtube_channel: userData.channelName,
              content_type: userData.contentType,
              created_at: new Date().toISOString()
            }
          ]);

        if (error) throw error;
        return true;
      } catch (error) {
        console.error('Error creating user profile:', error);
        throw new Error('Failed to create user profile');
      }
    }

    // Sign up user
    async function signUpUser(userData) {
      try {
        // Create auth user
        const { data: authData, error: authError } = await supabase.auth.signUp({
          email: userData.email,
          password: userData.password,
          options: {
            data: {
              first_name: userData.firstName,
              last_name: userData.lastName,
              youtube_channel: userData.channelName
            }
          }
        });

        if (authError) {
          if (authError.message.includes('User already registered')) {
            throw new Error('An account with this email already exists');
          } else {
            throw authError;
          }
        }

        if (authData.user) {
          // Create user profile
          await createUserProfile(authData.user.id, userData);
          
          showNotification('Account created successfully! Redirecting to login...', 'success');
          
          // Redirect to login page
          setTimeout(() => {
            window.location.href = 'login.html?signup=success&email=' + encodeURIComponent(userData.email);
          }, 2000);
          
          return true;
        }

      } catch (error) {
        throw error;
      }
    }

    // Form submission handler
    document.getElementById("signup-form").addEventListener("submit", async (e) => {
      e.preventDefault();
      
      const signupBtn = document.getElementById('signupBtn');
      
      // Collect form data
      const formData = {
        firstName: document.getElementById('firstName').value.trim(),
        lastName: document.getElementById('lastName').value.trim(),
        email: document.getElementById('email').value.trim(),
        channelName: document.getElementById('channelName').value.trim(),
        contentType: document.getElementById('contentType').value,
        password: document.getElementById('password').value,
        confirmPassword: document.getElementById('confirmPassword').value
      };
      
      // Validate form
      const errors = validateForm(formData);
      if (errors.length > 0) {
        showNotification(errors[0]);
        return;
      }
      
      // Show loading state
      signupBtn.disabled = true;
      signupBtn.classList.add('loading');
      signupBtn.innerHTML = '<span>Creating Account...</span>';
      
      try {
        await signUpUser(formData);
      } catch (error) {
        console.error('Signup error:', error);
        showNotification(error.message);
        
        signupBtn.disabled = false;
        signupBtn.classList.remove('loading');
        signupBtn.innerHTML = '<span>Create Account</span>';
      }
    });

    // Password strength indicator
    document.getElementById('password').addEventListener('input', function() {
      checkPasswordStrength(this.value);
    });

    // Real-time password validation
    document.getElementById('confirmPassword').addEventListener('input', function() {
      const password = document.getElementById('password').value;
      const confirmPassword = this.value;
      
      if (confirmPassword && password !== confirmPassword) {
        this.classList.add('error');
      } else {
        this.classList.remove('error');
      }
    });

    // Clear error styling when user starts typing
    const formInputs = document.querySelectorAll('input, select');
    formInputs.forEach(input => {
      input.addEventListener('input', function() {
        this.classList.remove('error');
      });
    });

    // Auto-focus first name field
    document.getElementById('firstName').focus();

    // Check if user is already logged in
    document.addEventListener('DOMContentLoaded', async function() {
      const { data: { session } } = await supabase.auth.getSession();
      
      if (session) {
        showNotification('You are already logged in. Redirecting...', 'success');
        setTimeout(() => {
          window.location.href = 'dashboard.html';
        }, 2000);
      }
    });
  </script>
</body>
</html>
